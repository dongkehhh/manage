<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="keywords" content="scclui框架">
    <meta name="description" content="scclui为轻量级的网站后台管理系统模版。">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <!--<link rel="stylesheet" type="text/css" href="../common/esayui/easyui.css">
    <link rel="stylesheet" type="text/css" href="../common/esayui/icon.css">-->
    <script type="text/javascript" src="common/esayui/jquery.min.js"></script>
    <script type="text/javascript" src="common/esayui/jquery.easyui.min.js"></script>
    <link rel="stylesheet" type="text/css" href="http://www.jeasyui.com/easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="http://www.jeasyui.com/easyui/themes/icon.css">
    <title>首页</title>
    <script>
        var url;
        function doSearch(){
            $('#tt').datagrid('load',{
                name: $('#itemid').val()
            });
        }
        function editUser(){
            var row = $('#tt').datagrid('getSelected');
            if (row){
                $('#dlg').dialog('open').dialog('center').dialog('setTitle','Edit User');
                $('#fm').form('load',row);
                url = 'select/id?id='+row.id;
            }
        }

        function saveUser(){
            $('#fm').form('submit',{
                url: url,
                onSubmit: function(){
                    return $(this).form('validate');
                },
                success: function(result){
                     result = eval('('+result+')');
                    if (result.errorMsg){
                        $.messager.show({
                            title: 'Error',
                            msg: result.errorMsg
                        });
                    } else {
                        $('#dlg').dialog('close');
                        $('#dg').datagrid('reload');
                    }
                }
            });
        }

        function destroyUser(){
            var row = $('#tt').datagrid('getSelected');
            if (row){
                $.messager.confirm('Confirm','是否删除这个学员',function(r){
                    if (r){
                        $.post('select/updateid',{id:row.id},function(result){
                            if (result.success){
                                $('#tt').datagrid('reload');	// reload the user data
                            } else {
                                $.messager.show({	// show error message
                                    title: 'Error',
                                    msg: result.errorMsg
                                });
                            }
                        },'json');
                    }
                });
            }
        }

        function newUser(){
            $('#dlg').dialog('open').dialog('setTitle','New User');
            $('#fm').form('clear');
            url = 'save_user.php';
        }
    </script>
</head>


<body>
<table id="tt" class="easyui-datagrid" style="width:800px;height:400px"
       url="select/student"
       title="学员信息" iconCls="icon-save"  toolbar="#toolbar" fitColumns="true"  singleSelect="true"
       rownumbers="true" pagination="true" pageNumber="1"  pageSize="5" pageList="[5, 10, 15]">
    <thead>
    <tr>
        <th field="id" width="80">编号</th>
        <th field="name" width="80">姓名</th>
        <th field="learntime" width="80" align="right">当前课时</th>
        <th field="classid" width="80" align="right">所在班级</th>
        <th field="teachername" width="100">所属教师</th>
        <th field="opendate" width="260" align="center">入学时间</th>
    </tr>
    </thead>
</table>
<div id="toolbar" style="padding:5px;height:auto">
    <a href="#" class="easyui-linkbutton" iconCls="icon-add" plain="true" onclick="newUser()">新增学员</a>
    <a href="#" class="easyui-linkbutton" iconCls="icon-edit" plain="true" onclick="editUser()">修改学员信息</a>
    <a href="#" class="easyui-linkbutton" iconCls="icon-remove" plain="true" onclick="destroyUser()">删除学员</a>
    <br/>
    <span>姓名:</span>
    <input id="itemid" style="line-height:26px;border:1px solid #ccc">
    <a href="#" class="easyui-linkbutton" plain="true" onclick="doSearch()">查询</a>
</div>
<div id="dlg" class="easyui-dialog" style="width:400px;height:280px;padding:10px 20px"
     closed="true" buttons="#dlg-buttons">
    <div class="ftitle">新增学员</div>
    <form id="fm" method="post">
        <div class="fitem">
            <label>姓名:</label>
            <input name="name" class="easyui-validatebox" required="true">
        </div>
        <div class="fitem">
            <label>当前课时:</label>
            <input name="learntime" class="easyui-validatebox" required="true">
        </div>
        <div class="fitem">
            <label>所在班级:</label>
            <input name="classid">
        </div>
        <div class="fitem">
            <label>所属教师:</label>
            <input name="teachername" class="easyui-validatebox" required="true">
        </div>
       <!-- validType="email"-->
        <!--<div class="fitem">
            <label>入学时间:</label>
            <input name="opendate" class="easyui-validatebox" required="true">
        </div>-->
    </form>
</div>
<div id="dlg-buttons">
    <a href="#" class="easyui-linkbutton" iconCls="icon-ok" onclick="saveUser()">Save</a>
    <a href="#" class="easyui-linkbutton" iconCls="icon-cancel" onclick="javascript:$('#dlg').dialog('close')">Cancel</a>
</div>
</body>
</html>
